<%- layout("layouts/boilerplate.ejs") %>

    <body>
        <div class="container mt-4">
            <!-- Total Counts Section -->
            <div class="text-center mb-4">
                <h2 class="display-4">Dashboard Overview</h2>
                <p class="text-muted">Quick summary of resources and recent activity</p>
            </div>

            <div class="row text-center">
                <!-- Card for Total Colleges -->
                <div class="col-md-3 mb-3">
                    <a href="/colleges" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-primary">Colleges</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalColleges %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total PYQs -->
                <div class="col-md-3 mb-3">
                    <a href="/pyqs" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-success">PYQs</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalPYQs %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Notes -->
                <div class="col-md-3 mb-3">
                    <a href="/notes" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-info">Notes</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalNotes %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Groups -->
                <div class="col-md-3 mb-3">
                    <a href="/whatsappgroup" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-warning">Groups</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalGroups %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Seniors -->
                <div class="col-md-3 mb-3">
                    <a href="/seniors" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-danger">Seniors</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalSeniors %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Communities -->
                <div class="col-md-3 mb-3">
                    <div class="card bg-light border-0 shadow-sm hover-card">
                        <div class="card-body">
                            <h5 class="card-title text-secondary">Communities</h5>
                            <h4 class="font-weight-bold text-dark">0</h4>
                        </div>
                    </div>
                </div>

                <!-- Card for Total Store Products -->
                <div class="col-md-3 mb-3">
                    <a href="/store" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-purple">Store Products</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalProduct %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Admins -->
                <div class="col-md-3 mb-3">
                    <a href="/user" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-dark">Admins</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalUsers %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Card for Total Users -->
                <div class="col-md-3 mb-3">
                    <a href="/client" class="text-decoration-none">
                        <div class="card bg-light border-0 shadow-sm hover-card">
                            <div class="card-body">
                                <h5 class="card-title text-teal">Users</h5>
                                <h4 class="font-weight-bold text-dark">
                                    <%= totalClients %>
                                </h4>
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Recent Items Section -->
            <div class="mt-4">
                <div class="text-center mb-4">
                    <h2 class="display-5">Recent Items</h2>
                </div>

                <div class="row">
                    <!-- Recent PYQs -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-primary text-white">
                                Recent PYQs
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentPYQs.forEach(pyq=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/pyqs/<%= pyq._id %>" class="text-decoration-none hover-item">
                                            <%= pyq.subjectName %> - <%= pyq.subjectCode %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label" for="pyqSwitch<%= pyq._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="pyqSwitch<%= pyq._id %>" <%=pyq.status ? 'checked' : '' %>
                                            onchange="toggleStatus('<%= pyq._id %>', this.checked, 'pyq')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>


                    <!-- Recent Colleges -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-warning text-white">
                                Recent Colleges
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentColleges.forEach(college=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/colleges/<%= college._id %>" class="text-decoration-none hover-item">
                                            <%= college.name %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label"
                                                for="collegeSwitch<%= college._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="collegeSwitch<%= college._id %>" <%=college.status ? 'checked' : ''
                                                %>
                                            onchange="toggleStatus('<%= college._id %>', this.checked, 'college')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>

                    <!-- Recent Products -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-danger text-white">
                                Recent Products
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentProducts.forEach(product=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/store" class="text-decoration-none hover-item">
                                            <%= product.name %> - $<%= product.price %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label"
                                                for="productSwitch<%= product._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="productSwitch<%= product._id %>" <%=product.status ? 'checked' : ''
                                                %>
                                            onchange="toggleStatus('<%= product._id %>', this.checked, 'product')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>

                    <!-- Recent Seniors -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-success text-white">
                                Recent Seniors
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentSeniors.forEach(senior=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/seniors/<%= senior._id %>" class="text-decoration-none hover-item">
                                            <%= senior.name %> - <%= senior.branch %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label"
                                                for="seniorSwitch<%= senior._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="seniorSwitch<%= senior._id %>" <%=senior.status ? 'checked' : '' %>
                                            onchange="toggleStatus('<%= senior._id %>', this.checked, 'senior')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>

                    <!-- Recent Notes -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-info text-white">
                                Recent Notes
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentNotes.forEach(note=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/notes" class="text-decoration-none hover-item">
                                            <%= note.subjectName %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label"
                                                for="noteSwitch<%= note._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="noteSwitch<%= note._id %>" <%=note.status ? 'checked' : '' %>
                                            onchange="toggleStatus('<%= note._id %>', this.checked, 'note')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>

                    <!-- Recent Groups -->
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-secondary text-white">
                                Recent Groups
                            </div>
                            <ul class="list-group list-group-flush">
                                <% recentGroups.forEach(group=> { %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="/whatsappgroup" class="text-decoration-none hover-item">
                                            <%= group.title %>
                                        </a>
                                        <!-- Toggle Button -->
                                        <div class="form-check form-switch">
                                            <label class="form-check-label"
                                                for="groupSwitch<%= group._id %>">Status</label>
                                            <input class="form-check-input" type="checkbox" role="switch"
                                                id="groupSwitch<%= group._id %>" <%=group.status ? 'checked' : '' %>
                                            onchange="toggleStatus('<%= group._id %>', this.checked, 'group')">
                                        </div>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hover card effect -->
        <style>
            .hover-card:hover {
                transform: scale(1.05);
                transition: transform 0.3s ease-in-out;
            }

            .hover-item:hover {
                background-color: #f8f9fa;
                transition: background-color 0.2s ease-in-out;
            }

            .card-header {
                font-weight: bold;
            }

            li:hover {
                background-color: rgb(255, 255, 234);
            }
        </style>

        <script>
            function toggleStatus(id, status, type) {
                fetch(`/toggle-status/${type}/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ status }),
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            console.log(`${type} status updated successfully`);
                        } else {
                            console.error(`Failed to update ${type} status`);
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }

        </script>
    </body>